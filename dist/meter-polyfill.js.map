{"version":3,"sources":["meter-polyfill.js"],"names":["root","factory","define","amd","module","exports","meterPolyfill","this","window","each","arrLike","fn","i","len","length","on","el","events","listener","useCapture","split","event","support","addEventListener","attachEvent","hasAttribute","name","getAttribute","isMeter","tagName","toUpperCase","METER_TAGNAME","fixProps","meter","props","METER_PROPS","prop","PROP_MAX","PROP_MIN","PROP_LOW","PROP_HIGH","PROP_VALUE","removeAttribute","PROP_OPTIMUN","calcLevel","min","max","low","high","optimum","value","percentage","level","LEVEL_OPTIMUN","LEVEL_SUBOPTIMUN","LEVEL_SUBSUBOPTIMUN","isFirefox","createShadow","native","innerHTML","METER_SHADOW_HTML","setAttribute","METER_INITAL_VALUES","updateMeterStyle","setMeterAttribute","attr","pollyfillGetterSetter","getSetter","toLowerCase","getGetter","isGetterSetterPolyfilled","unknownElement","prototype","meterElement","constructor","syncAttribute","set","get","Object","defineProperty","innerDivs","getElementsByTagName","valueElement","isNaN","className","METER_VALUE_CLASSES","style","width","observer","isObservered","MutationObserver","mutations","mutation","polyfill","target","observe","documentElement","attributes","attributeFilter","subtree","childList","e","context","meters","METER_CLASS_PREFIX","inner","bar","document","WebKitMutationObserver","isReady","navigator","userAgent","indexOf","createElement","join","Math","setTimeout","readyState","isTop","frameElement","_","doScroll","autoPolyfill","CLASSES","INITAL_VALUES","fix","calc"],"mappings":"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","file":"meter-polyfill.js","sourcesContent":["/* globals define: true, module: true*/\n(function(root, factory) {\n  'use strict';\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define([], function() {\n      return factory(root);\n    });\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = factory(root);\n  } else {\n    root.meterPolyfill = factory(root);\n  }\n})(this, function(window) {\n  'use strict';\n\n  var LEVEL_SUBOPTIMUN = 0;\n  var LEVEL_OPTIMUN = 1;\n  var LEVEL_SUBSUBOPTIMUN = 2;\n  var PROP_MIN = 'min';\n  var PROP_MAX = 'max';\n  var PROP_LOW = 'low';\n  var PROP_HIGH = 'high';\n  var PROP_VALUE = 'value';\n  var PROP_OPTIMUN = 'optimum';\n  var METER_PROPS = [PROP_MIN, PROP_MAX, PROP_LOW, PROP_HIGH, PROP_VALUE, PROP_OPTIMUN];\n  var METER_TAGNAME = 'METER';\n  var METER_CLASS_PREFIX = 'meter-';\n\n  var METER_VALUE_CLASSES = {\n    inner: METER_CLASS_PREFIX + 'inner-element',\n    bar: METER_CLASS_PREFIX + 'bar'\n  };\n\n  METER_VALUE_CLASSES[LEVEL_OPTIMUN] = METER_CLASS_PREFIX + 'optimum-value';\n  METER_VALUE_CLASSES[LEVEL_SUBOPTIMUN] = METER_CLASS_PREFIX + 'suboptimum-value';\n  METER_VALUE_CLASSES[LEVEL_SUBSUBOPTIMUN] = METER_CLASS_PREFIX + 'even-less-good-value';\n\n  var document = window.document;\n  var documentElement = document.documentElement;\n  // there is no moz/ms/o vendor prefix\n  var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;\n  var isGetterSetterPolyfilled = false;\n  var isObservered = false;\n  var isReady = false;\n  // TODO\n  // use getComputedStyle find the right calculator\n  var isFirefox = window.navigator.userAgent.indexOf('Firefox') > -1;\n\n  var meterElement = document.createElement(METER_TAGNAME);\n  meterElement.low = '1';\n  meterElement.setAttribute(PROP_HIGH, '1');\n\n  var support = {\n    native: meterElement[PROP_MAX] === 1,\n    MutationObserver: typeof MutationObserver !== 'undefined',\n    addEventListener: !!window.addEventListener,\n    attachEvent: !!window.attachEvent,\n    syncAttribute: meterElement.getAttribute(PROP_LOW) === '1' && meterElement[PROP_HIGH] === '1',\n    unknownElement: !!meterElement.constructor,\n    hasAttribute: !!meterElement.hasAttribute\n  };\n\n  var METER_INITAL_VALUES = {\n    min: 0,\n    max: 1,\n    low: 0,\n    high: 1\n  };\n\n  var METER_SHADOW_HTML = [\n    '<div class=\"' + METER_VALUE_CLASSES.inner + '\">',\n      '<div class=\"' + METER_VALUE_CLASSES.bar + '\">',\n        '<div class=\"' + METER_VALUE_CLASSES[LEVEL_SUBOPTIMUN] + '\" style=\"width: 0\">',\n        '</div>',\n      '</div>',\n    '</div>'\n  ].join('');\n\n  var min = Math.min;\n  var max = Math.max;\n  var setTimeout = window.setTimeout;\n\n  // help functions\n  function each(arrLike, fn) {\n    for (var i = 0, len = arrLike.length; i < len; i++) {\n      fn(arrLike[i], i);\n    }\n  }\n\n  function on(el, events, listener, useCapture) {\n    each(events.split(' '), function(event) {\n      if (support.addEventListener) {\n        el.addEventListener(event, listener, useCapture);\n      } else if (support.attachEvent) {\n        el.attachEvent('on' + event, listener);\n      } else {\n        el['on' + event] = listener;\n      }\n    });\n  }\n\n  function hasAttribute(el, name) {\n    if (support.hasAttribute) {\n      return el.hasAttribute(name);\n    } else {\n      return el.getAttribute(name) !== null;\n    }\n  }\n\n  function isMeter(el) {\n    return el && el.tagName && el.tagName.toUpperCase() === METER_TAGNAME;\n  }\n\n  function fixProps(meter, props) {\n    each(props || METER_PROPS, function(prop) {\n      switch (prop) {\n        case PROP_MAX:\n          if (meter[PROP_MAX] < meter[PROP_MIN]) {\n            meter[PROP_MAX] = meter[PROP_MIN];\n          }\n          break;\n        case PROP_LOW:\n          if (meter[PROP_LOW] < meter[PROP_MIN]) {\n            meter[PROP_LOW] = meter[PROP_MIN];\n          }\n          break;\n        case PROP_HIGH:\n          if (meter[PROP_HIGH] > meter[PROP_MAX]) {\n            meter[PROP_HIGH] = meter[PROP_MAX];\n          }\n          if (meter[PROP_HIGH] < meter[PROP_LOW]) {\n            meter[PROP_HIGH] = meter[PROP_LOW];\n          }\n          break;\n        case PROP_VALUE:\n          if (isMeter(meter) && typeof meter[PROP_VALUE] === 'undefined') {\n            meter.removeAttribute(PROP_VALUE);\n          } else {\n            if (\n              (meter[PROP_VALUE] < meter[PROP_MIN]) ||\n              (typeof meter[PROP_VALUE] === 'undefined')\n            ) {\n              meter[PROP_VALUE] = meter[PROP_MIN];\n            }\n            if (meter[PROP_VALUE] > meter[PROP_MAX]) {\n              meter[PROP_VALUE] = meter[PROP_MAX];\n            }\n          }\n          break;\n        case PROP_OPTIMUN:\n          if (\n            (typeof meter[PROP_OPTIMUN] === 'undefined') ||\n            (meter[PROP_OPTIMUN] < meter[PROP_MIN] || meter[PROP_OPTIMUN] > meter[PROP_MAX])\n          ) {\n            if (isMeter(meter)) {\n              meter.removeAttribute(PROP_OPTIMUN);\n            } else {\n              meter[PROP_OPTIMUN] = meter[PROP_MIN] + (meter[PROP_MAX] - meter[PROP_MIN]) / 2;\n            }\n          }\n          break;\n        default:\n          break;\n      }\n    });\n    return meter;\n  }\n\n  function calcLevel(props) {\n    var min = props[PROP_MIN];\n    var max = props[PROP_MAX];\n    var low = props[PROP_LOW];\n    var high = props[PROP_HIGH];\n    var optimum = props[PROP_OPTIMUN];\n    var value = props[PROP_VALUE];\n\n    var percentage = min === max ? 0 : (value - min) / (max - min) * 100;\n    var level = LEVEL_OPTIMUN;\n\n    if (\n      high === max ||\n      low === min ||\n      (optimum >= low && optimum <= high)\n    ) {\n      if (\n        (low <= optimum && value < low) ||\n        (low > optimum && value > low) ||\n        (high < optimum && value < high) ||\n        (high >= optimum && value > high)\n      ) {\n        level = LEVEL_SUBOPTIMUN;\n      }\n    } else if (low === high) {\n      if (\n        (low <= optimum && value < low) ||\n        (high > optimum && value > high)\n      ) {\n        level = LEVEL_SUBSUBOPTIMUN;\n      }\n    } else if (optimum < low) {\n      if (value > low && value <= high) {\n        level = LEVEL_SUBOPTIMUN;\n      } else if (value > high) {\n        level = LEVEL_SUBSUBOPTIMUN;\n      }\n    } else if (optimum > high) {\n      if (value >= low && value < high) {\n        level = LEVEL_SUBOPTIMUN;\n      } else if (value < low) {\n        level = LEVEL_SUBSUBOPTIMUN;\n      }\n    }\n\n    // firefox show diffently from chrome when\n    // value === high\n\n    if (isFirefox &&\n      (\n        (optimum > high && value === high) ||\n        (optimum < low && value === low)\n      )\n     ) {\n      level = LEVEL_SUBOPTIMUN;\n    }\n\n\n    return {\n      percentage: percentage,\n      level: level\n    };\n  }\n\n  function createShadow(meter) {\n    if (support.native || !isMeter(meter) || hasAttribute(meter, '_polyfill')) {\n      return meter;\n    }\n\n    meter.innerHTML = METER_SHADOW_HTML;\n    meter.setAttribute('_polyfill', '');\n    // must has a min/max value\n    each([PROP_MIN, PROP_MAX], function(prop) {\n      if (typeof meter[prop] === 'undefined') {\n        meter[prop] = METER_INITAL_VALUES[prop];\n      }\n    });\n\n    fixProps(meter, [PROP_MAX, PROP_LOW, PROP_HIGH, PROP_VALUE]);\n    updateMeterStyle(meter);\n    return meter;\n  }\n\n  function setMeterAttribute(meter, attr, value) {\n    switch (attr) {\n      case PROP_MIN:\n        meter.setAttribute(attr, value);\n        fixProps(meter, [PROP_MAX, PROP_LOW, PROP_HIGH, PROP_VALUE, PROP_OPTIMUN]);\n        break;\n      case PROP_MAX:\n        value = max(value, meter[PROP_MAX]);\n        meter.setAttribute(attr, value);\n        fixProps(meter, [PROP_LOW, PROP_HIGH, PROP_VALUE, PROP_OPTIMUN]);\n        break;\n      case PROP_LOW:\n        value = min(max(value, meter[PROP_MIN]), meter[PROP_MAX]);\n        meter.setAttribute(attr, value);\n        fixProps(meter, [PROP_HIGH]);\n        break;\n      case PROP_HIGH:\n        value = min(max(value, meter[PROP_MIN], meter[PROP_LOW]), meter[PROP_MAX]);\n        meter.setAttribute(attr, value);\n        break;\n      case PROP_OPTIMUN:\n        value = min(max(value, meter[PROP_MIN]), meter[PROP_MAX]);\n        meter.setAttribute(attr, value);\n        break;\n      default:\n        meter.setAttribute(attr, value);\n    }\n    updateMeterStyle(meter);\n  }\n\n  function pollyfillGetterSetter() {\n    if (isGetterSetterPolyfilled || !support.unknownElement) {\n      return;\n    }\n\n    var prototype = meterElement.constructor.prototype;\n    function getSetter(prop) {\n      return function(value) {\n        if (isMeter(this)) {\n          setMeterAttribute(this, prop.toLowerCase(), +value);\n        } else {\n          return this[prop] = value;\n        }\n      };\n    }\n\n    function getGetter(prop) {\n      return function() {\n        if (isMeter(this)) {\n          if (hasAttribute(this, prop)) {\n            return +this.getAttribute(prop);\n          } else if (prop === PROP_LOW) {\n            return this[PROP_MIN];\n          } else if (prop === PROP_HIGH) {\n            return this[PROP_MAX];\n          } else if (prop === PROP_OPTIMUN) {\n            return (this[PROP_MAX] - this[PROP_MIN]) / 2 + this[PROP_MIN];\n          } else if (prop === PROP_VALUE) {\n            return this[PROP_MIN];\n          }\n          return METER_INITAL_VALUES[prop];\n        } else {\n          return this[prop];\n        }\n      };\n    }\n\n    each(METER_PROPS, function(prop) {\n      var props = {};\n      if (!support.syncAttribute) {\n        props.set = getSetter(prop);\n      }\n      props.get = getGetter(prop);\n      Object.defineProperty(prototype, prop, props);\n    });\n\n    isGetterSetterPolyfilled = true;\n  }\n\n  function updateMeterStyle(meter) {\n    if (support.native) {\n      return;\n    }\n\n    var innerDivs = meter.getElementsByTagName('div');\n    if (!innerDivs.length) {\n      return createShadow(meter);\n    }\n    var valueElement = innerDivs[2];\n\n    var props = {};\n    each(METER_PROPS, function(prop) {\n      if (support.unknownElement) {\n        props[prop] = +meter[prop];\n      } else if (hasAttribute(meter, prop)) {\n        var value = +meter.getAttribute(prop);\n        if (isNaN(value)) {\n          props[prop] = METER_INITAL_VALUES[prop];\n        } else {\n          props[prop] = value;\n        }\n      }else {\n        props[prop] = METER_INITAL_VALUES[prop];\n      }\n    });\n\n    // ie8 return no fixed props\n    if (support.syncAttribute) {\n      props = fixProps(props);\n    }\n    var level = calcLevel(props);\n    valueElement.className = METER_VALUE_CLASSES[level.level];\n    valueElement.style.width = level.percentage + '%';\n\n    return meter;\n  }\n\n  function observer() {\n    if (isObservered) {\n      return;\n    }\n    if (support.MutationObserver) {\n      var observer = new MutationObserver(function(mutations) {\n        each(mutations, function(mutation) {\n          polyfill(mutation.target);\n        });\n      });\n      observer.observe(documentElement, {\n        attributes: true,\n        attributeFilter: METER_PROPS,\n        subtree: true,\n        childList: true\n      });\n    } else {\n      on(documentElement, 'DOMNodeInserted DOMAttrModified', function(e) {\n        polyfill(e.target);\n      });\n    }\n    isObservered = true;\n  }\n\n  function polyfill(context) {\n    if (support.native) {\n      return;\n    }\n\n    var meters = [];\n    if (isMeter(context)) {\n      meters = [context];\n    } else {\n      meters = (context || documentElement).getElementsByTagName('meter');\n    }\n\n    pollyfillGetterSetter();\n    each(meters, function(meter) {\n      createShadow(meter);\n    });\n\n    observer();\n  }\n\n  (function checkReady() {\n    if (document.readyState === 'complete') {\n      isReady = true;\n    }\n\n    on(document, 'DOMContentLoaded', function() {\n      isReady = true;\n    });\n\n    on(window, 'load', function() {\n      isReady = true;\n    });\n\n    // uglify will break window without a wrapper\n    var isTop = false;\n    try {\n      isTop === window.frameElement === null;\n    } catch (_) {}\n\n\n    if (!support.addEventListener && documentElement.doScroll && isTop) {\n      (function doScroll() {\n        try {\n          documentElement.doScroll('left');\n        } catch (_) {\n          return setTimeout(doScroll, 50);\n        }\n        isReady = true;\n      })();\n    }\n  })();\n\n  (function autoPolyfill() {\n    if (!isReady) {\n      setTimeout(autoPolyfill, 50);\n    } else {\n      polyfill();\n    }\n  })();\n\n  return {\n    CLASSES: METER_VALUE_CLASSES,\n    INITAL_VALUES: METER_INITAL_VALUES,\n    LEVEL_SUBOPTIMUN: LEVEL_SUBOPTIMUN,\n    LEVEL_OPTIMUN: LEVEL_OPTIMUN,\n    LEVEL_SUBSUBOPTIMUN: LEVEL_SUBSUBOPTIMUN,\n    polyfill: polyfill,\n    fix: fixProps,\n    calc: calcLevel\n  };\n\n});\n"]}