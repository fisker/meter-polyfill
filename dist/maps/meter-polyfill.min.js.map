{"version":3,"sources":["meter-polyfill.min.js"],"names":["root","factory","define","amd","module","exports","meterPolyfill","this","window","isMeter","el","tagName","toUpperCase","METER_TAG","each","arrLike","fn","i","len","length","isUndefined","obj","isVoidValue","floatValue","parseFloat","isNaN","isFinite","getPropValue","meter","prop","value","isNull","min","max","low","PROP_MIN","METER_INITAL_VALUES","PROP_MAX","mathMax","PROP_LOW","mathMin","PROP_HIGH","PROP_OPTIMUM","PROP_VALUE","fixProps","propValues","METER_PROPS","calcLevel","high","optimum","percentage","level","LEVEL_OPTIMUM","LEVEL_SUBOPTIMUM","LEVEL_SUBSUBOPTIMUM","isFirefox","className","METER_VALUE_CLASSES","createNativeFunction","fnName","toString","nativeToString","bind","call","on","events","listener","useCapture","split","event","supports","addEventListener","attachEvent","hasAttribute","name","getAttribute","updateMeterStyle","valueElement","getElementsByTagName","style","width","_","observerSubtree","isObservered","MutationObserver","observer","mutations","mutation","polyfill","target","observe","documentElement","subtree","childList","DOMNodeInserted","e","context","meters","document","POLYFILL_SIGN","constructor","HTMLMeterElement","createShadowDom","defineEtter","observerAttr","setAttribute","attributes","attributeFilter","DOMAttrModified","join","indexOf","attrName","propertychange","propertyName","srcElement","canHaveChildren","canHaveHTML","parent","parentNode","meterClone","createElement","replaceChild","innerHTML","METER_SHADOW_HTML","slashMeters","slashMeter","removeChild","getGetter","getSetter","TypeError","HTML_METER_ELEMENT_CONSTRICTOR_NAME","METHOD_SET_ATTRIBUTE","METHOD_CLONE_NODE","cloneNode","etters","get","attersAsProps","set","defineProperty","attributeSetter","attr","toLowerCase","cloneNodeMethd","deep","clone","removeAttribute","NOOP","METER_CLASS_PREFIX","inner","bar","METHOD_CREATE_ELEMENT","navigator","userAgent","meterElement","nativeSupport","CLASSES","calc","Object","o","property","enumerable","configurable","number","__defineGetter__","__defineSetter__","Function","prototype","oThis","args","Array","slice","arguments","fnToBind","fnBound","apply","concat","replace","$1","$2","options","HTMLElement","Element","Node","create","WebKitMutationObserver","isReady","unknownElement","supportsDOMNodeInserted","supportsDOMAttrModified","testDiv","testChild","appendChild","Math","setTimeout","checkReady","completed","readyState","isTop","frameElement","doScroll","polyfillWhenReady"],"mappings":"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","file":"../meter-polyfill.min.js","sourcesContent":["/* globals define: true, module: true*/\n(function(root, factory) {\n  'use strict';\n\n  if (typeof define === 'function' && define.amd) {\n    define(factory(root));\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = factory(root);\n  } else {\n    root.meterPolyfill = factory(root);\n  }\n})(this, function(window) {\n  'use strict';\n\n  var METER_TAG = '<%= METER_TAG %>';\n\n  var NOOP = function() {};\n\n  var LEVEL_OPTIMUM = 1;\n  var LEVEL_SUBOPTIMUM = 2;\n  var LEVEL_SUBSUBOPTIMUM = 3;\n  var METER_CLASS_PREFIX = 'meter-';\n\n  var METER_VALUE_CLASSES = {\n    inner: METER_CLASS_PREFIX + 'inner-element',\n    bar: METER_CLASS_PREFIX + 'bar'\n  };\n\n  METER_VALUE_CLASSES[LEVEL_OPTIMUM] = METER_CLASS_PREFIX + 'optimum-value';\n  METER_VALUE_CLASSES[LEVEL_SUBOPTIMUM] = METER_CLASS_PREFIX + 'suboptimum-value';\n  METER_VALUE_CLASSES[LEVEL_SUBSUBOPTIMUM] = METER_CLASS_PREFIX + 'even-less-good-value';\n\n  var PROP_MIN = 'min';\n  var PROP_MAX = 'max';\n  var PROP_LOW = 'low';\n  var PROP_HIGH = 'high';\n  var PROP_VALUE = 'value';\n  var PROP_OPTIMUM = 'optimum';\n\n  var METER_PROPS = [PROP_MIN, PROP_MAX, PROP_LOW, PROP_HIGH, PROP_OPTIMUM, PROP_VALUE];\n\n  var METHOD_CREATE_ELEMENT = 'createElement';\n\n  var METER_INITAL_VALUES = {\n    min: 0,\n    max: 1\n  };\n\n  // TODO:\n  // use getComputedStyle find the right calculator\n  var isFirefox = window.navigator.userAgent.indexOf('Firefox') > -1;\n\n  var document = window.document;\n\n  var meterElement = document[METHOD_CREATE_ELEMENT](METER_TAG);\n  var nativeSupport = meterElement[PROP_MAX] === METER_INITAL_VALUES[PROP_MAX];\n\n  function isMeter(el) {\n    return el && el.tagName && el.tagName.toUpperCase() === METER_TAG;\n  }\n\n  function each(arrLike, fn) {\n    var i = 0;\n    var len = arrLike.length;\n    for (; i < len; i++) {\n      fn(arrLike[i], i);\n    }\n  }\n\n  function isUndefined(obj) {\n    return typeof obj === 'undefined';\n  }\n\n  function isVoidValue(obj) {\n    var floatValue = parseFloat(obj);\n    return isUndefined(obj) || isNaN(floatValue) || !isFinite(floatValue);\n  }\n\n  function getPropValue(meter, prop) {\n    var value = meter[prop];\n    var isNull = value === null;\n    var min;\n    var max;\n    var low;\n    value = parseFloat(value);\n    switch (prop) {\n      case PROP_MIN:\n        value = isNull ?\n          METER_INITAL_VALUES[PROP_MIN] :\n          value;\n        break;\n      case PROP_MAX:\n        min = getPropValue(meter, PROP_MIN);\n        value = isNull ?\n          mathMax(min, METER_INITAL_VALUES[PROP_MAX]) :\n          mathMax(min, value);\n        break;\n      case PROP_LOW:\n        min = getPropValue(meter, PROP_MIN);\n        max = getPropValue(meter, PROP_MAX);\n        value = isNull ?\n          min :\n          mathMin(mathMax(min, value), max);\n        break;\n      case PROP_HIGH:\n        max = getPropValue(meter, PROP_MAX);\n        low = getPropValue(meter, PROP_LOW);\n        value = isNull ?\n          max :\n          mathMin(mathMax(low, value), max);\n        break;\n      case PROP_OPTIMUM:\n        min = getPropValue(meter, PROP_MIN);\n        max = getPropValue(meter, PROP_MAX);\n        value = isNull ?\n          (max - min) / 2 + min :\n          mathMin(mathMax(min, value), max);\n        break;\n      case PROP_VALUE:\n        min = getPropValue(meter, PROP_MIN);\n        max = getPropValue(meter, PROP_MAX);\n        value = isNull ?\n          min :\n          mathMin(mathMax(min, value), max);\n        break;\n      default:\n        break;\n    }\n    return value;\n  }\n\n  function fixProps(propValues) {\n    each(METER_PROPS, function(prop) {\n      var value = propValues[prop];\n      if (isVoidValue(value)) {\n        value = null;\n      }\n      if (propValues[prop] !== value) {\n        propValues[prop] = value;\n      }\n    });\n    return propValues;\n  }\n\n  function calcLevel(meter) {\n    var propValues = {};\n    each(METER_PROPS, function(prop) {\n      propValues[prop] = meter[prop];\n    });\n    propValues = fixProps(propValues);\n\n    var min = getPropValue(propValues, PROP_MIN);\n    var max = getPropValue(propValues, PROP_MAX);\n    var low = getPropValue(propValues, PROP_LOW);\n    var high = getPropValue(propValues, PROP_HIGH);\n    var optimum = getPropValue(propValues, PROP_OPTIMUM);\n    var value = getPropValue(propValues, PROP_VALUE);\n\n    var percentage = min === max ? 0 : (value - min) / (max - min) * 100;\n    var level = LEVEL_OPTIMUM;\n\n    if (\n      high === max ||\n      low === min ||\n      (optimum >= low && optimum <= high)\n    ) {\n      if (\n        (low <= optimum && value < low) ||\n        (low > optimum && value > low) ||\n        (high < optimum && value < high) ||\n        (high >= optimum && value > high)\n      ) {\n        level = LEVEL_SUBOPTIMUM;\n      }\n    } else if (low === high) {\n      if (\n        (low <= optimum && value < low) ||\n        (high > optimum && value > high)\n      ) {\n        level = LEVEL_SUBSUBOPTIMUM;\n      }\n    } else if (optimum < low) {\n      if (value > low && value <= high) {\n        level = LEVEL_SUBOPTIMUM;\n      } else if (value > high) {\n        level = LEVEL_SUBSUBOPTIMUM;\n      }\n    } else if (optimum > high) {\n      if (value >= low && value < high) {\n        level = LEVEL_SUBOPTIMUM;\n      } else if (value < low) {\n        level = LEVEL_SUBSUBOPTIMUM;\n      }\n    }\n\n    // firefox show diffently from chrome\n    // when value === high/low or min === max\n    if (isFirefox) {\n      if (min === max) {\n        percentage = 100;\n      }\n\n      if (\n          (optimum > high && value === high) ||\n          (optimum < low && value === low)\n       ) {\n        level = LEVEL_SUBOPTIMUM;\n      }\n    }\n\n    return {\n      percentage: percentage,\n      level: level,\n      className: METER_VALUE_CLASSES[level]\n    };\n  }\n\n  var meterPolyfill = {\n    CLASSES: METER_VALUE_CLASSES,\n    LEVEL_SUBOPTIMUM: LEVEL_SUBOPTIMUM,\n    LEVEL_OPTIMUM: LEVEL_OPTIMUM,\n    LEVEL_SUBSUBOPTIMUM: LEVEL_SUBSUBOPTIMUM,\n    calc: calcLevel,\n    polyfill: NOOP\n  };\n\n  if (nativeSupport) {\n    return meterPolyfill;\n  }\n\n  /* polyfill starts */\n\n  var POLYFILL_SIGN = '_polyfill';\n\n  var documentElement = document.documentElement;\n\n  var defineProperty;\n  if (Object.defineProperty) {\n    defineProperty = function(o, property, etters) {\n      etters.enumerable = true;\n      etters.configurable = true;\n\n      try {\n        Object.defineProperty(o, property, etters);\n      } catch (e) {\n        if (e.number === -0x7FF5EC54) {\n          etters.enumerable = false;\n          Object.defineProperty(o, property, etters);\n        }\n      }\n    };\n  } else {\n    if ('__defineSetter__' in documentElement) {\n      defineProperty = function(o, property, etters) {\n        if (etters.get) {\n          o.__defineGetter__(property, etters.get);\n        }\n        if (etters.set) {\n          o.__defineSetter__(property, etters.set);\n        }\n      };\n    } else {\n      defineProperty = function(o, property, etters) {\n        if (etters.get) {\n          o[property] = etters.get.call(o);\n        }\n      };\n    }\n  }\n\n  // https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Function/bind\n  var bind = Function.prototype.bind || function(oThis) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    var fnToBind = this;\n    var NOOP = function() {};\n    var fnBound = function() {\n        return fnToBind.apply(\n          this instanceof NOOP ? this : oThis || this,\n          args.concat(Array.prototype.slice.call(arguments))\n          );\n    };\n\n    if (this.prototype) {\n      NOOP.prototype = this.prototype;\n    }\n    fnBound.prototype = new NOOP();\n\n    return fnBound;\n  };\n\n  var HTML_METER_ELEMENT_CONSTRICTOR_NAME = [\n    'HTML',\n    METER_TAG.replace(/^(.)(.*)$/, function(_, $1, $2) {\n        return $1.toUpperCase() + $2.toLowerCase();\n    }),\n    'Element'\n  ].join('');\n\n  function createNativeFunction(fnName, fn) {\n    function toString() {\n      return 'function ' + fnName + '() { [native code] }';\n    }\n\n    var nativeToString = toString.toString.toString;\n\n    // firfox shows bound toString in console not bug\n    // ie7/8 is buggy without bind\n    toString.toString = bind.call(nativeToString, nativeToString);\n    // some browsers shows empty function name in toString.toString.toString\n    toString.toString.toString = toString.toString;\n\n    fn.toString = toString;\n    return fn;\n  }\n\n  // ie 8 document.createElement is not a function\n  // ie 7 document.createElement.apply is undefined\n  var createElement = (function(createElement) {\n    if (createElement.apply) {\n      return function() {\n        return createElement.apply(document, arguments);\n      };\n    } else {\n      return function(tagName, options) {\n        return createElement(tagName, options);\n      };\n    }\n  })(document[METHOD_CREATE_ELEMENT]);\n\n  var HTMLMeterElement = window[HTML_METER_ELEMENT_CONSTRICTOR_NAME] || (function() {\n    var HTMLMeterElement = createNativeFunction(HTML_METER_ELEMENT_CONSTRICTOR_NAME, function() {\n      throw new TypeError('Illegal constructor');\n    });\n\n    // ie 8 constructor is null\n    var prototype = (\n      window.HTMLElement ||\n      meterElement.constructor ||\n      window.Element ||\n      window.Node ||\n      NOOP).prototype;\n\n    if (Object.create) {\n      prototype = Object.create(prototype);\n    }\n\n    HTMLMeterElement.prototype = prototype;\n    HTMLMeterElement.constructor = HTMLMeterElement.prototype.constructor = HTMLMeterElement;\n\n    return window[HTML_METER_ELEMENT_CONSTRICTOR_NAME] = HTMLMeterElement;\n  })();\n\n  // there is no moz/ms/o vendor prefix\n  var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;\n  var isObservered = false;\n  var isReady = false;\n\n  meterElement[METER_TAG] = METER_TAG; // for attersAsProps test\n  var supports = {\n    MutationObserver: !!MutationObserver,\n    addEventListener: !!window.addEventListener,\n    attachEvent: !!window.attachEvent,\n    attersAsProps: meterElement.getAttribute(METER_TAG) === METER_TAG, // (IE8- bug)\n    unknownElement: !!meterElement.constructor,\n    hasAttribute: !!meterElement.hasAttribute,\n    propertychange: 'onpropertychange' in document\n  };\n\n  function on(el, events, listener, useCapture) {\n    if (!el) {\n      return;\n    }\n    each(events.split(' '), function(event) {\n      if (supports.addEventListener) {\n        el.addEventListener(event, listener, !!useCapture);\n      } else if (supports.attachEvent) {\n        el.attachEvent('on' + event, listener);\n      } else {\n        el['on' + event] = listener;\n      }\n    });\n  }\n\n  if (!supports.MutationObserver) {\n    var supportsDOMNodeInserted = false;\n    var supportsDOMAttrModified = false;\n    var testDiv = createElement('div');\n    var testChild = createElement('div');\n    on(testDiv, 'DOMNodeInserted', function() {\n      supportsDOMNodeInserted = true;\n    });\n    testDiv.appendChild(testChild);\n    on(testDiv, 'DOMAttrModified', function() {\n      supportsDOMAttrModified = true;\n    });\n    testDiv.setAttribute(PROP_MIN, 1);\n    testChild = null;\n    testDiv = null;\n\n    supports.DOMNodeInserted = supportsDOMNodeInserted;\n    supports.DOMAttrModified = supportsDOMAttrModified;\n  }\n\n  var METER_SHADOW_HTML = [\n    '<div class=\"' + METER_VALUE_CLASSES.inner + '\">',\n      '<div class=\"' + METER_VALUE_CLASSES.bar + '\">',\n        '<div class=\"' + METER_VALUE_CLASSES[LEVEL_SUBOPTIMUM] + '\" style=\"width: 0\">',\n        '</div>',\n      '</div>',\n    '</div>'\n  ].join('');\n\n  var mathMin = Math[PROP_MIN];\n  var mathMax = Math[PROP_MAX];\n  var setTimeout = window.setTimeout;\n\n  function hasAttribute(el, name) {\n    if (supports.hasAttribute) {\n      return el.hasAttribute(name);\n    } else {\n      return el.getAttribute(name) !== null;\n    }\n  }\n\n  function updateMeterStyle(meter) {\n    var level = calcLevel(meter);\n\n    try {\n      var valueElement = meter.getElementsByTagName('div')[2];\n      valueElement.className = level.className;\n      valueElement.style.width = level.percentage + '%';\n    } catch (_) {}\n\n    return meter;\n  }\n\n  // over write document.createElement\n  document[METHOD_CREATE_ELEMENT] = createNativeFunction(METHOD_CREATE_ELEMENT, function() {\n    var el = createElement.apply(document, arguments);\n    if (isMeter(el)) {\n      polyfill(el);\n    }\n    return el;\n  });\n\n  function observerSubtree() {\n    if (isObservered) {\n      return;\n    }\n\n    // observe subtree\n    if (supports.MutationObserver) {\n      var observer = new MutationObserver(function(mutations) {\n        each(mutations, function(mutation) {\n          polyfill(mutation.target);\n        });\n      });\n\n      observer.observe(documentElement, {\n        subtree: true,\n        childList: true\n      });\n    } else if (supports.DOMNodeInserted) {\n      on(documentElement, 'DOMNodeInserted', function(e) {\n        polyfill(e.target);\n      });\n    } else {\n      // any idea ?\n    }\n    isObservered = true;\n  }\n\n  function polyfill(context) {\n    var meters = [];\n    if (isMeter(context)) {\n      meters = [context];\n    } else {\n      meters = (context || document).getElementsByTagName(METER_TAG);\n    }\n\n    each(meters, function(meter) {\n      if (meter[POLYFILL_SIGN]) {\n        return;\n      }\n\n      if (!hasAttribute(meter, POLYFILL_SIGN)) {\n        // ie 8 throws\n        try {\n          meter.constructor = HTMLMeterElement;\n        } catch (_) {}\n\n        // ie8 need clone meter might be a new node\n        meter = createShadowDom(meter);\n        defineEtter(meter);\n        observerAttr(meter);\n\n        meter.setAttribute(POLYFILL_SIGN, '');\n      }\n\n      updateMeterStyle(meter);\n      meter[POLYFILL_SIGN] = true;\n    });\n  }\n\n  function observerAttr(meter) {\n    // observe subtree\n    if (supports.MutationObserver) {\n      var observer = new MutationObserver(function(mutations) {\n        each(mutations, function(mutation) {\n          updateMeterStyle(mutation.target);\n        });\n      });\n      observer.observe(meter, {\n        attributes: true,\n        attributeFilter: METER_PROPS\n      });\n    } else if (supports.DOMAttrModified) {\n      on(meter, 'DOMAttrModified', function(e) {\n        if (METER_PROPS.join(' ').indexOf(e.attrName) > -1) {\n          updateMeterStyle(e.target);\n        }\n      });\n    } else if (supports.propertychange) {\n      on(meter, 'propertychange', function(e) {\n        if (METER_PROPS.join(' ').indexOf(e.propertyName) > -1) {\n          updateMeterStyle(e.srcElement);\n        }\n      });\n    } else {\n      // anything ?\n    }\n  }\n\n  function createShadowDom(meter) {\n    if (meter.canHaveChildren === false || meter.canHaveHTML === false) {\n      // ie 8 fails on innerHTML meter\n      var parent = meter.parentNode;\n      if (parent) {\n        var meterClone = createElement(METER_TAG);\n        each(METER_PROPS, function(prop) {\n          var value = meter[prop];\n          if (!isVoidValue(value)) {\n            meterClone[prop] = meter[prop];\n          }\n        });\n        parent.replaceChild(meterClone, meter);\n        meterClone.innerHTML = METER_SHADOW_HTML;\n        meter = meterClone;\n\n        // remove </meter><//meter>\n        var slashMeters = parent.getElementsByTagName('/' + METER_TAG);\n        each(slashMeters, function(slashMeter) {\n          parent.removeChild(slashMeter);\n        });\n\n        // anotherway remove </meter><//meter>\n        // var next = meter;\n        // while (next = next.nextSibling) {\n        //   if (next.tagName.toUpperCase() === '/' + METER_TAG) {\n        //     parent.removeChild(next);\n        //   }\n        // }\n      }\n    } else {\n      meter.innerHTML = METER_SHADOW_HTML;\n    }\n    return meter;\n  }\n\n  function defineEtter(meter) {\n    var METHOD_SET_ATTRIBUTE = 'setAttribute';\n    var METHOD_CLONE_NODE = 'cloneNode';\n    var propValues = {};\n    var setAttribute = bind.call(meter[METHOD_SET_ATTRIBUTE], meter);\n    var cloneNode = bind.call(meter[METHOD_CLONE_NODE], meter);\n\n    each(METER_PROPS, function(prop) {\n      propValues[prop] = meter.getAttribute(prop);\n    });\n\n    propValues = fixProps(propValues);\n\n    function getGetter(prop) {\n      return function() {\n        return getPropValue(propValues, prop);\n      };\n    }\n\n    function getSetter(prop) {\n      return function(value) {\n        if (isVoidValue(value)) {\n          throw new TypeError('Failed to set the \\'' + prop + '\\' property on \\'' + HTML_METER_ELEMENT_CONSTRICTOR_NAME + '\\': The provided double value is non-finite.');\n        }\n\n        setAttribute(prop, '' + meter[prop]);\n\n        propValues[prop] = value === null ? null : value;\n        updateMeterStyle(meter);\n        return value;\n      };\n    }\n\n    each(METER_PROPS, function(prop) {\n      var etters = {\n        get: getGetter(prop)\n      };\n      if (!supports.attersAsProps) {\n        etters.set = getSetter(prop);\n      }\n      defineProperty(meter, prop, etters);\n    });\n\n    var attributeSetter = createNativeFunction(METHOD_SET_ATTRIBUTE, function(attr, value) {\n      setAttribute(attr, value);\n      attr = attr.toLowerCase();\n      each(METER_PROPS, function(prop) {\n        if (prop === attr) {\n          propValues[prop] = isVoidValue(value) || value === null ? null : value;\n          updateMeterStyle(meter);\n        }\n      });\n    });\n\n    defineProperty(meter, METHOD_SET_ATTRIBUTE, {\n      value: attributeSetter\n    });\n\n    var cloneNodeMethd = createNativeFunction(METHOD_CLONE_NODE, function(deep) {\n      var clone = cloneNode(false);\n      clone.removeAttribute(POLYFILL_SIGN);\n      polyfill(clone);\n      return clone;\n    });\n\n    defineProperty(meter, METHOD_CLONE_NODE, {\n      value: cloneNodeMethd\n    });\n  }\n\n  (function checkReady() {\n\n    function completed() {\n      if (document.readyState === 'complete') {\n        isReady = true;\n      }\n    }\n    completed();\n\n    on(document, 'DOMContentLoaded', function() {\n      isReady = true;\n    });\n\n    on(window, 'load', function() {\n      isReady = true;\n    });\n\n    on(document, 'readystatechange', completed);\n\n    // uglify will break window without a wrapper\n    var isTop = false;\n    try {\n      isTop = window.frameElement === null;\n    } catch (_) {}\n\n    if (!supports.addEventListener && documentElement.doScroll && isTop) {\n      (function doScroll() {\n        try {\n          documentElement.doScroll();\n        } catch (_) {\n          return setTimeout(doScroll, 50);\n        }\n        isReady = true;\n      })();\n    }\n  })();\n\n  (function polyfillWhenReady() {\n    if (isReady) {\n      polyfill();\n      observerSubtree();\n    } else {\n      setTimeout(polyfillWhenReady, 50);\n    }\n  })();\n\n  meterPolyfill.polyfill = polyfill;\n  return meterPolyfill;\n});\n"]}